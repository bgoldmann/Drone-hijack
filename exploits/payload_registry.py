#!/usr/bin/env python3
"""
Payload Registry
Comprehensive registry of all 73+ payloads organized by severity level
"""

PAYLOAD_REGISTRY = {
    'CRITICAL': [
        {
            'id': 'mavlink_inject',
            'name': 'MAVLink Command Injection',
            'script': 'injection/mavlink_inject.py',
            'category': 'injection',
            'cvss': 9.8,
            'cve': 'CVE-2020-10282',
            'description': 'MAVLink authentication missing - allows command injection',
            'args': ['connection', 'command'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'dji_enhanced_wifi_exploit',
            'name': 'DJI Enhanced WiFi Protocol Exploitation',
            'script': 'advanced/dji_enhanced_wifi_exploit.py',
            'category': 'advanced',
            'cvss': 9.8,
            'cve': 'CVE-2025-10250',
            'description': 'Exploit DJI Enhanced WiFi Protocol vulnerabilities for drone hijacking (WEP key recovery in 20 seconds)',
            'args': ['interface', 'ssid', 'channel', 'bssid'],
            'targets': ['DJI'],
            'dependencies': []
        }
    ],
    'HIGH': [
        {
            'id': 'buffer_overflow_cve_2024_40427',
            'name': 'Stack Buffer Overflow (CVE-2024-40427)',
            'script': 'injection/buffer_overflow_cve_2024_40427.py',
            'category': 'injection',
            'cvss': 7.9,
            'cve': 'CVE-2024-40427',
            'description': 'Stack buffer overflow in PX4-Autopilot v1.14.3',
            'args': ['connection'],
            'targets': ['PX4'],
            'dependencies': []
        },
        {
            'id': 'logger_overflow_cve_2024_38952',
            'name': 'Logger Buffer Overflow (CVE-2024-38952)',
            'script': 'injection/logger_overflow_cve_2024_38952.py',
            'category': 'injection',
            'cvss': 7.5,
            'cve': 'CVE-2024-38952',
            'description': 'Logger buffer overflow in PX4-Autopilot',
            'args': ['connection'],
            'targets': ['PX4'],
            'dependencies': []
        },
        {
            'id': 'holy_stone_ble_rce_cve_2024_52876',
            'name': 'Holy Stone BLE RCE (CVE-2024-52876)',
            'script': 'hardware/holy_stone_ble_rce_cve_2024_52876.py',
            'category': 'hardware',
            'cvss': 7.5,
            'cve': 'CVE-2024-52876',
            'description': 'Remote code execution via BLE on Holy Stone drones',
            'args': ['device_address'],
            'targets': ['Holy Stone'],
            'dependencies': []
        },
        {
            'id': 'trajectory_overflow_cve_2025_5640',
            'name': 'Trajectory Buffer Overflow (CVE-2025-5640)',
            'script': 'injection/trajectory_overflow_cve_2025_5640.py',
            'category': 'injection',
            'cvss': 7.0,  # High severity, CVSS not yet assigned
            'cve': 'CVE-2025-5640',
            'description': 'Stack buffer overflow in trajectory waypoints',
            'args': ['connection'],
            'targets': ['PX4'],
            'dependencies': []
        },
        {
            'id': 'geofence_bypass',
            'name': 'Geofence Bypass',
            'script': 'injection/geofence_bypass.py',
            'category': 'injection',
            'cvss': 7.0,
            'cve': 'CVE-2024-30800',
            'description': 'Bypass geofence restrictions',
            'args': ['connection', 'action'],
            'targets': ['PX4', 'ArduPilot'],
            'dependencies': []
        },
        {
            'id': 'mavlink_mitm',
            'name': 'MAVLink Man-in-the-Middle',
            'script': 'mitm/mavlink_mitm.py',
            'category': 'mitm',
            'cvss': 7.0,
            'cve': None,
            'description': 'Unencrypted MAVLink communication allows MITM',
            'args': ['source_connection', 'target_connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'flight_termination',
            'name': 'Flight Termination',
            'script': 'dos/flight_termination.py',
            'category': 'dos',
            'cvss': 7.0,
            'cve': None,
            'description': 'Send flight termination command',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'firmware_extraction',
            'name': 'Firmware Extraction',
            'script': 'firmware/firmware_extraction.py',
            'category': 'firmware',
            'cvss': 7.0,
            'cve': None,
            'description': 'Extract firmware from flight controller',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'waypoint_override',
            'name': 'Waypoint Override',
            'script': 'injection/waypoint_override.py',
            'category': 'injection',
            'cvss': 7.0,
            'cve': None,
            'description': 'Override mission waypoints',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'return_to_home_override',
            'name': 'Return to Home Override',
            'script': 'injection/return_to_home_override.py',
            'category': 'injection',
            'cvss': 7.0,
            'cve': None,
            'description': 'Override home position',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'gimbal_takeover',
            'name': 'Camera Gimbal Takeover',
            'script': 'injection/gimbal_takeover.py',
            'category': 'injection',
            'cvss': 6.5,
            'cve': None,
            'description': 'Take control of camera gimbal',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'gcs_spoofing',
            'name': 'Ground Control Station Spoofing',
            'script': 'injection/gcs_spoofing.py',
            'category': 'injection',
            'cvss': 6.5,
            'cve': None,
            'description': 'Spoof GCS system ID to impersonate legitimate ground station',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'parameter_manipulation',
            'name': 'Parameter Manipulation',
            'script': 'injection/parameter_manipulation.py',
            'category': 'injection',
            'cvss': 6.5,
            'cve': None,
            'description': 'Modify critical system parameters',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'flight_log_extraction',
            'name': 'Flight Log Extraction',
            'script': 'exfiltration/flight_log_extraction.py',
            'category': 'exfiltration',
            'cvss': 6.5,
            'cve': None,
            'description': 'Extract ArduPilot BIN flight logs',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'mission_extraction',
            'name': 'Mission Extraction',
            'script': 'exfiltration/mission_extraction.py',
            'category': 'exfiltration',
            'cvss': 6.5,
            'cve': None,
            'description': 'Download mission waypoints',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'parameter_extraction',
            'name': 'Parameter Extraction',
            'script': 'exfiltration/parameter_extraction.py',
            'category': 'exfiltration',
            'cvss': 6.5,
            'cve': None,
            'description': 'Extract all system parameters',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'mavlink2_signature_bypass',
            'name': 'MAVLink 2.0 Signature Bypass',
            'script': 'injection/mavlink2_signature_bypass.py',
            'category': 'injection',
            'cvss': 7.5,
            'cve': None,
            'description': 'Bypass MAVLink 2.0 package signing to inject unsigned commands',
            'args': ['connection', 'command', 'mode_id'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'px4_safety_button_bypass',
            'name': 'PX4 Safety Button Bypass',
            'script': 'injection/px4_safety_button_bypass.py',
            'category': 'injection',
            'cvss': 7.0,
            'cve': None,
            'description': 'Bypass PX4 safety button requirements to arm drone without physical button press',
            'args': ['connection'],
            'targets': ['PX4'],
            'dependencies': []
        },
        {
            'id': 'px4_preflight_bypass',
            'name': 'PX4 Preflight Check Bypass',
            'script': 'injection/px4_preflight_bypass.py',
            'category': 'injection',
            'cvss': 7.0,
            'cve': None,
            'description': 'Bypass PX4 preflight safety checks to allow takeoff with unsafe conditions',
            'args': ['connection'],
            'targets': ['PX4'],
            'dependencies': []
        },
        {
            'id': 'swarm_coordination_attack',
            'name': 'Swarm Coordination Attack',
            'script': 'swarm/swarm_coordination_attack.py',
            'category': 'swarm',
            'cvss': 7.5,
            'cve': None,
            'description': 'Attack swarm coordination mechanisms to disrupt or hijack swarm operations',
            'args': ['connection', 'attack_type'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'swarm_controller_hijack',
            'name': 'Swarm Controller Hijack',
            'script': 'swarm/swarm_controller_hijack.py',
            'category': 'swarm',
            'cvss': 8.0,
            'cve': None,
            'description': 'Hijack the swarm controller to take control of entire swarm',
            'args': ['controller_connection'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'firmware_backdoor',
            'name': 'Firmware Backdoor',
            'script': 'persistence/firmware_backdoor.py',
            'category': 'persistence',
            'cvss': 8.5,
            'cve': None,
            'description': 'Install persistent backdoor in drone firmware',
            'args': ['connection', 'backdoor_type'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'adversarial_object_detection',
            'name': 'Adversarial Object Detection',
            'script': 'ai/adversarial_object_detection.py',
            'category': 'ai',
            'cvss': 7.0,
            'cve': None,
            'description': 'Fool ML-based object detection systems using adversarial examples',
            'args': ['connection', 'attack_mode'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'tracking_manipulation',
            'name': 'Tracking Manipulation',
            'script': 'ai/tracking_manipulation.py',
            'category': 'ai',
            'cvss': 7.0,
            'cve': None,
            'description': 'Manipulate ML-based tracking systems to cause tracking failures',
            'args': ['connection', 'manipulation_type'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'autonomous_decision_poisoning',
            'name': 'Autonomous Decision Poisoning',
            'script': 'ai/autonomous_decision_poisoning.py',
            'category': 'ai',
            'cvss': 8.0,
            'cve': None,
            'description': 'Poison ML-based autonomous decision systems to cause incorrect decisions',
            'args': ['connection', 'poison_type'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'parameter_persistence',
            'name': 'Parameter Persistence',
            'script': 'persistence/parameter_persistence.py',
            'category': 'persistence',
            'cvss': 7.0,
            'cve': None,
            'description': 'Modify parameters to maintain persistent access and control',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'startup_script_injection',
            'name': 'Startup Script Injection',
            'script': 'persistence/startup_script_injection.py',
            'category': 'persistence',
            'cvss': 7.5,
            'cve': None,
            'description': 'Inject malicious scripts into drone startup process',
            'args': ['connection', 'script_file'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        }
    ],
    'MEDIUM': [
        {
            'id': 'buffer_overflow_cve_2024_38951',
            'name': 'MAVLink Message Overflow (CVE-2024-38951)',
            'script': 'injection/buffer_overflow_cve_2024_38951.py',
            'category': 'injection',
            'cvss': 6.5,
            'cve': 'CVE-2024-38951',
            'description': 'MAVLink message overflow in PX4-Autopilot',
            'args': ['connection'],
            'targets': ['PX4'],
            'dependencies': []
        },
        {
            'id': 'flight_path_manipulation_cve_2024_29460',
            'name': 'Flight Path Manipulation (CVE-2024-29460)',
            'script': 'injection/flight_path_manipulation_cve_2024_29460.py',
            'category': 'injection',
            'cvss': 6.6,
            'cve': 'CVE-2024-29460',
            'description': 'Flight path manipulation causing crashes',
            'args': ['connection'],
            'targets': ['PX4'],
            'dependencies': []
        },
        {
            'id': 'breach_return_point_rce_cve_2024_30799',
            'name': 'Breach Return Point RCE (CVE-2024-30799)',
            'script': 'injection/breach_return_point_rce_cve_2024_30799.py',
            'category': 'injection',
            'cvss': 4.4,
            'cve': 'CVE-2024-30799',
            'description': 'Remote code execution via breach return point',
            'args': ['connection'],
            'targets': ['PX4'],
            'dependencies': []
        },
        {
            'id': 'use_after_free_cve_2025_9020',
            'name': 'Use-After-Free (CVE-2025-9020)',
            'script': 'injection/use_after_free_cve_2025_9020.py',
            'category': 'injection',
            'cvss': 4.5,
            'cve': 'CVE-2025-9020',
            'description': 'Use-after-free vulnerability in serial control',
            'args': ['connection'],
            'targets': ['PX4'],
            'dependencies': []
        },
        {
            'id': 'mission_race_condition',
            'name': 'Mission Race Condition',
            'script': 'injection/mission_race_condition.py',
            'category': 'injection',
            'cvss': 4.2,
            'cve': 'CVE-2024-24254, CVE-2024-24255',
            'description': 'Race condition in mission planning',
            'args': ['connection'],
            'targets': ['PX4'],
            'dependencies': []
        },
        {
            'id': 'flight_mode_injection',
            'name': 'Flight Mode Injection',
            'script': 'injection/flight_mode_injection.py',
            'category': 'injection',
            'cvss': 5.5,
            'cve': None,
            'description': 'Force drone into specific flight modes',
            'args': ['connection', 'mode'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'companion_computer_exploit',
            'name': 'Companion Computer Exploitation',
            'script': 'injection/companion_computer_exploit.py',
            'category': 'injection',
            'cvss': 5.5,
            'cve': None,
            'description': 'Exploit vulnerabilities in companion computer services',
            'args': ['target_ip'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'web_ui_brute_force',
            'name': 'Web UI Brute Force',
            'script': 'injection/web_ui_brute_force.py',
            'category': 'injection',
            'cvss': 5.5,
            'cve': None,
            'description': 'Brute force login credentials on companion computer web interface',
            'args': ['target_url'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'gps_spoofing',
            'name': 'GPS Spoofing',
            'script': 'tampering/gps_spoofing.py',
            'category': 'tampering',
            'cvss': 6.0,
            'cve': None,
            'description': 'Inject fake GPS coordinates',
            'args': ['connection', 'lat', 'lon', 'alt'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'battery_spoofing',
            'name': 'Battery Spoofing',
            'script': 'tampering/battery_spoofing.py',
            'category': 'tampering',
            'cvss': 5.5,
            'cve': None,
            'description': 'Spoof battery telemetry',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'attitude_spoofing',
            'name': 'Attitude Spoofing',
            'script': 'tampering/attitude_spoofing.py',
            'category': 'tampering',
            'cvss': 5.5,
            'cve': None,
            'description': 'Inject false attitude data',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'sensor_data_injection',
            'name': 'Sensor Data Injection',
            'script': 'tampering/sensor_data_injection.py',
            'category': 'tampering',
            'cvss': 5.5,
            'cve': None,
            'description': 'Inject IMU/barometer/magnetometer data',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'vfr_hud_spoofing',
            'name': 'VFR HUD Spoofing',
            'script': 'tampering/vfr_hud_spoofing.py',
            'category': 'tampering',
            'cvss': 5.0,
            'cve': None,
            'description': 'Spoof Visual Flight Rules HUD data',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'system_status_spoofing',
            'name': 'System Status Spoofing',
            'script': 'tampering/system_status_spoofing.py',
            'category': 'tampering',
            'cvss': 5.0,
            'cve': None,
            'description': 'Manipulate system status messages',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'satellite_spoofing',
            'name': 'Satellite Spoofing',
            'script': 'tampering/satellite_spoofing.py',
            'category': 'tampering',
            'cvss': 5.0,
            'cve': None,
            'description': 'Falsify GPS satellite count',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'emergency_status_spoofing',
            'name': 'Emergency Status Spoofing',
            'script': 'tampering/emergency_status_spoofing.py',
            'category': 'tampering',
            'cvss': 5.0,
            'cve': None,
            'description': 'Inject false emergency status flags',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'critical_error_spoofing',
            'name': 'Critical Error Spoofing',
            'script': 'tampering/critical_error_spoofing.py',
            'category': 'tampering',
            'cvss': 5.0,
            'cve': None,
            'description': 'Inject false error messages',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'communication_flooding',
            'name': 'Communication Flooding',
            'script': 'dos/communication_flooding.py',
            'category': 'dos',
            'cvss': 5.5,
            'cve': None,
            'description': 'Flood MAVLink channel with messages',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'geofence_attack',
            'name': 'Geofence Attack',
            'script': 'dos/geofence_attack.py',
            'category': 'dos',
            'cvss': 5.5,
            'cve': None,
            'description': 'Trigger false geofence violations',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'gps_offset_glitching',
            'name': 'GPS Offset Glitching',
            'script': 'dos/gps_offset_glitching.py',
            'category': 'dos',
            'cvss': 5.0,
            'cve': None,
            'description': 'Gradually shift GPS position to trigger geofence violations',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'denial_of_takeoff',
            'name': 'Denial of Takeoff',
            'script': 'dos/denial_of_takeoff.py',
            'category': 'dos',
            'cvss': 5.0,
            'cve': None,
            'description': 'Prevent drone from taking off',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'wifi_deauth',
            'name': 'WiFi Deauthentication',
            'script': 'dos/wifi_deauth.py',
            'category': 'dos',
            'cvss': 5.5,
            'cve': None,
            'description': 'WiFi deauthentication attack',
            'args': ['interface', 'target_mac'],
            'targets': ['DJI', 'Parrot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'ros_topic_flooding',
            'name': 'ROS Topic Flooding',
            'script': 'dos/ros_topic_flooding.py',
            'category': 'dos',
            'cvss': 5.0,
            'cve': None,
            'description': 'Flood ROS camera topics to exhaust resources',
            'args': ['target_ip'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'camera_feed_eavesdropping',
            'name': 'Camera Feed Eavesdropping',
            'script': 'exfiltration/camera_feed_eavesdropping.py',
            'category': 'exfiltration',
            'cvss': 5.5,
            'cve': None,
            'description': 'Intercept RTSP camera streams',
            'args': ['rtsp_url'],
            'targets': ['DJI', 'Parrot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'wifi_client_data_leak',
            'name': 'WiFi Client Data Leak',
            'script': 'exfiltration/wifi_client_data_leak.py',
            'category': 'exfiltration',
            'cvss': 5.5,
            'cve': None,
            'description': 'Extract data from WiFi clients connected to drone network',
            'args': ['interface'],
            'targets': ['DJI', 'Parrot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'ftp_eavesdropping',
            'name': 'FTP Eavesdropping',
            'script': 'exfiltration/ftp_eavesdropping.py',
            'category': 'exfiltration',
            'cvss': 5.0,
            'cve': None,
            'description': 'Intercept FTP traffic and credentials',
            'args': ['target_ip'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'command_replay',
            'name': 'Command Replay',
            'script': 'replay/command_replay.py',
            'category': 'replay',
            'cvss': 5.5,
            'cve': None,
            'description': 'Capture and replay MAVLink commands',
            'args': ['connection', 'action', 'file'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'telemetry_replay',
            'name': 'Telemetry Replay',
            'script': 'replay/telemetry_replay.py',
            'category': 'replay',
            'cvss': 5.0,
            'cve': None,
            'description': 'Telemetry replay attack',
            'args': ['connection', 'file'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'arp_spoofing',
            'name': 'ARP Spoofing',
            'script': 'network/arp_spoofing.py',
            'category': 'network',
            'cvss': 5.5,
            'cve': None,
            'description': 'ARP spoofing for MITM attacks',
            'args': ['interface', 'target_ip', 'gateway_ip'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'dns_spoofing',
            'name': 'DNS Spoofing',
            'script': 'network/dns_spoofing.py',
            'category': 'network',
            'cvss': 5.0,
            'cve': None,
            'description': 'DNS spoofing attack',
            'args': ['interface', 'target_ip'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'firmware_analysis',
            'name': 'Firmware Analysis',
            'script': 'firmware/firmware_analysis.py',
            'category': 'firmware',
            'cvss': 5.0,
            'cve': None,
            'description': 'Analyze firmware binaries for vulnerabilities',
            'args': ['firmware_file'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': ['firmware_extraction']
        },
        {
            'id': 'wireless_network_exploit',
            'name': 'Wireless Network Exploitation',
            'script': 'infrastructure/wireless_network_exploit.py',
            'category': 'infrastructure',
            'cvss': 6.0,
            'cve': None,
            'description': 'Wireless network exploitation from drone',
            'args': ['target_network'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'data_interception',
            'name': 'Data Interception',
            'script': 'infrastructure/data_interception.py',
            'category': 'infrastructure',
            'cvss': 5.5,
            'cve': None,
            'description': 'Intercept wireless communications',
            'args': ['interface', 'duration'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'physical_payload_delivery',
            'name': 'Physical Payload Delivery',
            'script': 'infrastructure/physical_payload_delivery.py',
            'category': 'infrastructure',
            'cvss': 5.0,
            'cve': None,
            'description': 'Simulate physical payload delivery',
            'args': ['lat', 'lon', 'alt'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'multi_vector_attack',
            'name': 'Multi-Vector Infrastructure Attack',
            'script': 'infrastructure/multi_vector_attack.py',
            'category': 'infrastructure',
            'cvss': 6.5,
            'cve': None,
            'description': 'Multi-vector infrastructure attack coordination',
            'args': ['target_network', 'target_location'],
            'targets': ['Generic'],
            'dependencies': []
        }
    ],
    'LOW': [
        {
            'id': 'wifi_crack',
            'name': 'WiFi Password Cracking',
            'script': 'recon/wifi_crack.py',
            'category': 'recon',
            'cvss': 4.0,
            'cve': 'CVE-2025-10250, CVE-2023-6951',
            'description': 'Crack WiFi passwords (WEP/WPA2)',
            'args': ['interface', 'ssid', 'mode'],
            'targets': ['DJI', 'Parrot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'drone_discovery',
            'name': 'Drone Discovery',
            'script': 'recon/drone_discovery.py',
            'category': 'recon',
            'cvss': 3.0,
            'cve': None,
            'description': 'Discover drones on network',
            'args': ['network'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'packet_sniffing',
            'name': 'Packet Sniffing',
            'script': 'recon/packet_sniffing.py',
            'category': 'recon',
            'cvss': 3.5,
            'cve': None,
            'description': 'Capture and analyze MAVLink traffic',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'protocol_fingerprinting',
            'name': 'Protocol Fingerprinting',
            'script': 'recon/protocol_fingerprinting.py',
            'category': 'recon',
            'cvss': 3.0,
            'cve': None,
            'description': 'Identify system capabilities',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'gps_telemetry_tracking',
            'name': 'GPS Telemetry Tracking',
            'script': 'recon/gps_telemetry_tracking.py',
            'category': 'recon',
            'cvss': 3.0,
            'cve': None,
            'description': 'Track drone GPS position in real-time',
            'args': ['connection'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'gcs_discovery',
            'name': 'Ground Control Station Discovery',
            'script': 'recon/gcs_discovery.py',
            'category': 'recon',
            'cvss': 3.0,
            'cve': None,
            'description': 'Ground control station discovery',
            'args': ['network'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'companion_computer_discovery',
            'name': 'Companion Computer Discovery',
            'script': 'recon/companion_computer_discovery.py',
            'category': 'recon',
            'cvss': 3.0,
            'cve': None,
            'description': 'Companion computer service discovery',
            'args': ['network'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'expresslrs_uid_leakage',
            'name': 'ExpressLRS UID Leakage',
            'script': 'injection/expresslrs_uid_leakage.py',
            'category': 'injection',
            'cvss': 4.0,
            'cve': None,
            'description': 'ExpressLRS UID leakage attack',
            'args': ['connection'],
            'targets': ['ExpressLRS'],
            'dependencies': []
        },
        {
            'id': 'mavlink2_extension_exploit',
            'name': 'MAVLink 2.0 Extension Exploitation',
            'script': 'injection/mavlink2_extension_exploit.py',
            'category': 'injection',
            'cvss': 6.5,
            'cve': None,
            'description': 'Exploit MAVLink 2.0 extension fields to inject malicious data',
            'args': ['connection', 'payload_size'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'flytrap_attack',
            'name': 'FlyTrap Attack Framework',
            'script': 'advanced/flytrap_attack.py',
            'category': 'advanced',
            'cvss': 6.5,
            'cve': None,
            'description': 'Physical distance-pulling attack towards camera-based autonomous target tracking systems',
            'args': ['connection', 'attack_mode'],
            'targets': ['DJI', 'HoverAir'],
            'dependencies': []
        },
        {
            'id': 'acas_xu_exploitation',
            'name': 'ACAS-Xu System Exploitation',
            'script': 'advanced/acas_xu_exploitation.py',
            'category': 'advanced',
            'cvss': 6.5,
            'cve': None,
            'description': 'Exploit ACAS-Xu collision avoidance system vulnerabilities',
            'args': ['connection', 'exploit_method'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'parameter_validation_bypass',
            'name': 'Parameter Validation Bypass',
            'script': 'injection/parameter_validation_bypass.py',
            'category': 'injection',
            'cvss': 6.0,
            'cve': None,
            'description': 'Bypass ArduPilot parameter validation checks',
            'args': ['connection'],
            'targets': ['ArduPilot'],
            'dependencies': []
        },
        {
            'id': 'ekf_spoofing',
            'name': 'EKF Spoofing',
            'script': 'tampering/ekf_spoofing.py',
            'category': 'tampering',
            'cvss': 6.5,
            'cve': None,
            'description': 'Spoof EKF sensor fusion data to cause incorrect state estimation',
            'args': ['connection', 'spoof_type'],
            'targets': ['ArduPilot'],
            'dependencies': []
        },
        {
            'id': 'swarm_discovery',
            'name': 'Swarm Discovery',
            'script': 'swarm/swarm_discovery.py',
            'category': 'swarm',
            'cvss': 5.5,
            'cve': None,
            'description': 'Discover and map drone swarm topology and communication patterns',
            'args': ['network'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'sensor_fusion_poisoning',
            'name': 'Sensor Fusion Poisoning',
            'script': 'ai/sensor_fusion_poisoning.py',
            'category': 'ai',
            'cvss': 6.5,
            'cve': None,
            'description': 'Poison sensor fusion algorithms to cause incorrect state estimation',
            'args': ['connection', 'fusion_type'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'kalman_filter_attack',
            'name': 'Kalman Filter Attack',
            'script': 'ai/kalman_filter_attack.py',
            'category': 'ai',
            'cvss': 6.0,
            'cve': None,
            'description': 'Attack Kalman filter algorithms to cause incorrect state estimation',
            'args': ['connection', 'attack_method'],
            'targets': ['PX4', 'ArduPilot', 'Generic'],
            'dependencies': []
        },
        {
            'id': 'rf_jamming',
            'name': 'RF Jamming Attacks',
            'script': 'advanced/rf_jamming.py',
            'category': 'advanced',
            'cvss': 6.0,
            'cve': None,
            'description': 'Jam RF signals to disrupt drone communication',
            'args': ['interface', 'frequency', 'duration'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'micro_drone_hijacking',
            'name': 'Micro Drone Hijacking',
            'script': 'advanced/micro_drone_hijacking.py',
            'category': 'advanced',
            'cvss': 6.5,
            'cve': None,
            'description': 'Hijack micro aerial drones using specific attack vectors',
            'args': ['connection', 'attack_vector'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'usb_exploitation',
            'name': 'USB Exploitation',
            'script': 'hardware/usb_exploitation.py',
            'category': 'hardware',
            'cvss': 6.5,
            'cve': None,
            'description': 'Exploit USB interfaces on drone hardware',
            'args': ['vendor_id', 'product_id'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'serial_protocol_exploit',
            'name': 'Serial Protocol Exploitation',
            'script': 'hardware/serial_protocol_exploit.py',
            'category': 'hardware',
            'cvss': 6.0,
            'cve': None,
            'description': 'Exploit serial communication interfaces on drone hardware',
            'args': ['port', 'baudrate'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'ble_exploitation',
            'name': 'BLE Exploitation',
            'script': 'hardware/ble_exploitation.py',
            'category': 'hardware',
            'cvss': 6.5,
            'cve': None,
            'description': 'Exploit BLE interfaces on drone hardware',
            'args': ['device_address'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'ble_gatt_exploit',
            'name': 'BLE GATT Exploitation',
            'script': 'hardware/ble_gatt_exploit.py',
            'category': 'hardware',
            'cvss': 6.5,
            'cve': None,
            'description': 'Exploit GATT services and characteristics',
            'args': ['device_address', 'service_uuid'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'can_bus_injection',
            'name': 'CAN Bus Injection',
            'script': 'hardware/can_bus_injection.py',
            'category': 'hardware',
            'cvss': 6.5,
            'cve': None,
            'description': 'Inject malicious messages into CAN bus network',
            'args': ['interface', 'message_id', 'data'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'can_bus_replay',
            'name': 'CAN Bus Replay',
            'script': 'hardware/can_bus_replay.py',
            'category': 'hardware',
            'cvss': 6.0,
            'cve': None,
            'description': 'Replay captured CAN bus messages to exploit vulnerabilities',
            'args': ['interface', 'capture_file', 'message_id'],
            'targets': ['Generic'],
            'dependencies': []
        },
        {
            'id': 'jtag_swd_exploitation',
            'name': 'JTAG/SWD Exploitation',
            'script': 'hardware/jtag_swd_exploitation.py',
            'category': 'hardware',
            'cvss': 5.5,
            'cve': None,
            'description': 'Exploit JTAG/SWD debug interfaces for firmware access',
            'args': ['interface', 'target', 'action'],
            'targets': ['Generic'],
            'dependencies': []
        }
    ]
}


def get_all_payloads():
    """Get all payloads flattened into a single list"""
    all_payloads = []
    for severity in ['CRITICAL', 'HIGH', 'MEDIUM', 'LOW']:
        all_payloads.extend(PAYLOAD_REGISTRY[severity])
    return all_payloads


def get_payloads_by_severity(severity):
    """Get payloads for a specific severity level"""
    return PAYLOAD_REGISTRY.get(severity.upper(), [])


def get_payloads_by_category(category):
    """Get payloads for a specific category"""
    all_payloads = get_all_payloads()
    return [p for p in all_payloads if p['category'] == category.lower()]


def get_payload_by_id(payload_id):
    """Get a specific payload by ID"""
    all_payloads = get_all_payloads()
    for payload in all_payloads:
        if payload['id'] == payload_id:
            return payload
    return None


def get_total_count():
    """Get total number of payloads"""
    return len(get_all_payloads())


def get_count_by_severity():
    """Get count of payloads by severity"""
    return {
        'CRITICAL': len(PAYLOAD_REGISTRY['CRITICAL']),
        'HIGH': len(PAYLOAD_REGISTRY['HIGH']),
        'MEDIUM': len(PAYLOAD_REGISTRY['MEDIUM']),
        'LOW': len(PAYLOAD_REGISTRY['LOW'])
    }
