# Payload Orchestrator - Comprehensive Usage Guide

## Overview

The **Payload Orchestrator** is a comprehensive attack execution system that intelligently executes all 73+ available payloads from all 11 attack categories, ordered by severity level (CRITICAL → HIGH → MEDIUM → LOW). This tool provides a single interface to execute all available exploit scripts in an organized, severity-based manner.

## Features

- **Severity-Based Execution**: Executes payloads in order: CRITICAL → HIGH → MEDIUM → LOW
- **Comprehensive Coverage**: Executes all 73+ payloads from all 11 attack categories
- **Target Discovery**: Automatically discovers and fingerprints target drones
- **Compatibility Checking**: Skips payloads incompatible with target autopilot
- **Error Handling**: Continues execution even if individual payloads fail
- **Progress Tracking**: Real-time progress reporting
- **Comprehensive Logging**: Logs all execution attempts and results
- **JSON Reporting**: Generates detailed JSON reports
- **Flexible Filtering**: Filter by severity, category, or target compatibility
- **Dry Run Mode**: Preview what would be executed without running

## Installation

The Payload Orchestrator is included with the Damn Vulnerable Drone project. No additional installation is required.

**Dependencies**:
- Python 3.8+
- pymavlink
- All exploit scripts in the `exploits/` directory

## Usage

### Basic Usage

```bash
# Execute all payloads against local drone
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550

# Execute against network target
python3 exploits/payload_orchestrator.py 10.13.0.0/24

# Save report to file
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --output report.json
```

### Filtering Options

```bash
# Execute only CRITICAL severity payloads
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --severity CRITICAL

# Execute only HIGH severity payloads
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --severity HIGH

# Execute only injection category payloads
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --category injection

# Execute only tampering payloads
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --category tampering
```

### Execution Options

```bash
# Dry run - see what would be executed without running
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --dry-run

# Set timeout per payload (default: 60 seconds)
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --timeout 120

# Retry failed payloads (default: 0)
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --retry 2

# Skip reconnaissance phase
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --skip-recon

# Verbose output
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --verbose
```

## Command-Line Arguments

| Argument | Short | Description | Default |
|----------|-------|-------------|---------|
| `target` | - | Target connection string or network (required) | - |
| `--output` | `-o` | Output JSON report file | None |
| `--severity` | `-s` | Filter by severity (CRITICAL, HIGH, MEDIUM, LOW, ALL) | ALL |
| `--category` | `-c` | Filter by category | None |
| `--timeout` | `-t` | Timeout per payload in seconds | 60 |
| `--retry` | `-r` | Number of retries for failed payloads | 0 |
| `--skip-recon` | - | Skip reconnaissance phase | False |
| `--dry-run` | - | Show what would be executed without running | False |
| `--verbose` | `-v` | Verbose output | False |

## Attack Categories

The orchestrator supports all 11 attack categories:

1. **Injection** (20 payloads) - Command injection, buffer overflows, RCE
2. **Tampering** (9 payloads) - GPS spoofing, sensor data manipulation
3. **DoS** (7 payloads) - Denial of service attacks
4. **Exfiltration** (6 payloads) - Data extraction
5. **Reconnaissance** (7 payloads) - Information gathering
6. **MITM** (1 payload) - Man-in-the-middle attacks
7. **Replay** (2 payloads) - Command and telemetry replay
8. **Network** (2 payloads) - ARP/DNS spoofing
9. **Firmware** (3 payloads) - Firmware extraction and analysis
10. **Hardware** (1 payload) - Hardware-level exploits
11. **Infrastructure** (4 payloads) - Critical infrastructure attacks

## Severity Levels

Payloads are organized by severity:

- **CRITICAL** (1 payload): CVE-2020-10282 - MAVLink authentication missing (CVSS 9.8)
- **HIGH** (15 payloads): Buffer overflows, RCE, geofence bypass, etc. (CVSS 6.5-7.9)
- **MEDIUM** (38 payloads): Various injection, tampering, and DoS attacks (CVSS 4.0-6.6)
- **LOW** (8 payloads): Reconnaissance and information gathering (CVSS 3.0-4.0)

## Execution Flow

The orchestrator follows a 4-phase approach:

### Phase 1: Target Discovery
- Connects to target or scans network
- Identifies autopilot type (PX4, ArduPilot, etc.)
- Fingerprints system capabilities
- Maps target characteristics

### Phase 2: Payload Filtering
- Filters payloads by severity (if specified)
- Filters payloads by category (if specified)
- Checks target compatibility
- Skips incompatible payloads

### Phase 3: Payload Execution
- Orders payloads by severity and CVSS score
- Executes payloads sequentially within severity levels
- Handles errors gracefully
- Tracks execution time and results

### Phase 4: Report Generation
- Generates comprehensive JSON report
- Provides execution summary
- Shows results by severity
- Saves report to file (if specified)

## Report Structure

The JSON report includes:

```json
{
  "timestamp": "2026-01-22T12:00:00",
  "target": {
    "connection": "udp:127.0.0.1:14550",
    "autopilot": "ArduPilot",
    "firmware": "Unknown"
  },
  "execution_summary": {
    "total_payloads": 73,
    "executed": 65,
    "skipped": 8,
    "successful": 45,
    "failed": 20,
    "duration_seconds": 3600
  },
  "by_severity": {
    "CRITICAL": {"total": 1, "executed": 1, "successful": 1},
    "HIGH": {"total": 15, "executed": 15, "successful": 12},
    "MEDIUM": {"total": 38, "executed": 30, "successful": 20},
    "LOW": {"total": 8, "executed": 7, "successful": 5}
  },
  "payloads": [
    {
      "id": "mavlink_inject",
      "name": "MAVLink Command Injection",
      "severity": "CRITICAL",
      "status": "SUCCESS",
      "execution_time": 5.2,
      "output": "...",
      "error": null
    }
  ]
}
```

## Payload Status

Each payload can have one of the following statuses:

- **SUCCESS**: Payload executed successfully
- **FAILED**: Payload execution failed
- **TIMEOUT**: Payload execution exceeded timeout
- **ERROR**: Payload execution encountered an error
- **SKIPPED**: Payload was skipped (incompatible, missing script, etc.)
- **DRY_RUN**: Payload would be executed (dry run mode)

## Examples

### Example 1: Full Attack

```bash
# Execute all payloads against local drone
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --output full_attack.json
```

### Example 2: High Severity Only

```bash
# Execute only HIGH severity payloads
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --severity HIGH --output high_severity.json
```

### Example 3: Injection Attacks Only

```bash
# Execute only injection category payloads
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --category injection --output injection_attacks.json
```

### Example 4: Network Scan

```bash
# Scan network and execute payloads against discovered targets
python3 exploits/payload_orchestrator.py 10.13.0.0/24 --output network_scan.json
```

### Example 5: Dry Run

```bash
# Preview what would be executed
python3 exploits/payload_orchestrator.py udp:127.0.0.1:14550 --dry-run
```

## Integration with Existing Tools

The Payload Orchestrator integrates with:

- **Hail Mary Attack**: Uses similar vulnerability mapping
- **Vulnerability Scanner**: Leverages for target analysis
- **Drone Discovery**: Uses for network scanning
- **Chain Executor**: Similar execution patterns

## Performance Considerations

- **Execution Time**: Full execution of all 73+ payloads can take 30-60+ minutes
- **Timeout**: Default 60 seconds per payload (configurable)
- **Resource Usage**: Moderate CPU and network usage
- **Parallel Execution**: Currently sequential (parallel execution planned for future)

## Troubleshooting

### Common Issues

1. **Connection Failed**
   - Verify target is accessible
   - Check connection string format
   - UDP: `udp:127.0.0.1:14550`
   - TCP: `tcp:127.0.0.1:5760`

2. **Script Not Found**
   - Verify all exploit scripts are present
   - Check file permissions

3. **Timeout Errors**
   - Increase timeout with `--timeout` option
   - Some payloads may require longer execution time

4. **Import Errors**
   - Verify all dependencies are installed
   - Check Python path

## Legal and Ethical Considerations

⚠️ **CRITICAL WARNING**: 

- This tool executes multiple attack payloads
- Use only on systems you own or have explicit permission to test
- Unauthorized use is illegal in most jurisdictions
- Follow responsible disclosure practices

**Authorized Use Cases**:
- Security research with proper authorization
- Penetration testing with written consent
- Academic research with ethical review board approval
- Testing on your own systems

## Future Enhancements

Planned improvements:

- Parallel execution for independent payloads
- Configuration file support
- Real-time progress dashboard
- Integration with web management console
- AI/ML-based payload selection
- Swarm attack capabilities

## Support

For issues, questions, or contributions:

- Check existing documentation
- Review exploit script documentation
- Consult project README
- Open an issue on GitHub

## References

- [README.md](../README.md) - Project overview
- [VULNERABILITIES_AND_EXPLOITS.md](../VULNERABILITIES_AND_EXPLOITS.md) - Vulnerability details
- [HAIL_MARY_ATTACK.md](injection/HAIL_MARY_ATTACK.md) - Similar attack system
- [API_DOCUMENTATION.md](../API_DOCUMENTATION.md) - API reference

---

**Last Updated**: January 22, 2026  
**Version**: 1.0.0  
**Status**: Active Development
